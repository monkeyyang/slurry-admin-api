# 指定账号登录功能使用说明

## 功能概述

`ProcessItunesAccounts` 命令新增了 `--login-account` 参数，允许仅登录指定的单个账号，而不影响其他账号。

## 使用方法

### 基本语法

```bash
php artisan itunes:process-accounts --login-account=账号邮箱
```

### 示例

```bash
# 登录指定账号
php artisan itunes:process-accounts --login-account=test@example.com

# 登录另一个账号
php artisan itunes:process-accounts --login-account=another@example.com
```

## 功能特点

1. **精确登录**: 只登录指定的账号，不影响其他账号
2. **状态检查**: 自动检查账号是否已经登录，避免重复登录
3. **详细日志**: 提供完整的登录过程日志，包括：
   - 账号查找结果
   - 登录任务创建状态
   - 登录结果处理
   - 余额信息更新
4. **错误处理**: 完善的错误处理机制，包括：
   - 账号不存在的情况
   - API调用失败的处理
   - 登录超时的处理

## 执行流程

1. **账号查找**: 根据提供的邮箱地址查找对应账号
2. **状态验证**: 检查账号当前登录状态
3. **任务创建**: 创建登录任务并获取任务ID
4. **状态监控**: 定期查询任务状态直到完成
5. **结果处理**: 根据登录结果更新账号状态和余额信息

## 日志输出

命令会输出详细的日志信息，包括：

```
[2024-01-01 10:00:00] 开始执行指定账号登录操作，账号: test@example.com
[2024-01-01 10:00:01] 找到指定账号
[2024-01-01 10:00:02] 为指定账号创建登录任务
[2024-01-01 10:00:03] 指定账号登录任务创建成功
[2024-01-01 10:00:04] 等待指定账号登录任务完成
[2024-01-01 10:00:05] 指定账号登录成功
[2024-01-01 10:00:06] 指定账号余额更新
[2024-01-01 10:00:07] 指定账号登录操作完成
```

## 注意事项

1. **账号格式**: 必须提供完整的邮箱地址
2. **权限要求**: 确保账号在数据库中存在且有正确的密码信息
3. **网络要求**: 需要能够访问登录API服务
4. **超时设置**: 默认等待5分钟，超时后会记录警告日志

## 错误处理

- **账号不存在**: 会记录错误日志并退出
- **已经登录**: 会记录信息日志并跳过
- **API失败**: 会记录详细错误信息
- **登录失败**: 会更新账号状态为无效并记录失败原因

## 与其他参数的关系

- `--login-account` 与其他参数互斥
- 当使用 `--login-account` 时，不会执行其他操作
- 优先级：`--logout-only` > `--login-only` > `--fix-task` > `--login-account` > 默认操作 